{"name":"event.csv_flow","description":"","pipeline":{"version":"1.0","doc_type":"pipeline","app_data":{"shaperCreated":true,"replace_space_by_dot":true},"primary_pipeline":"pipeline1","pipelines":[{"id":"pipeline1","nodes":[{"id":"source1","data_asset":{"properties":{"file_name":"/data_asset/event.csv","first_line_header":"true","encoding":"UTF-8","invalid_data_handling":"fail","file_format":"csv"},"ref":"f5b7c707-e86e-43f5-b512-f82576e9f098","project_ref":"1ced1e1f-6da1-493b-b3e5-92cdf8bbc935","app_data":{}},"type":"binding","output":{"id":"source1output"}},{"id":"8c811ea7-0dbd-423b-9e89-2f0205610be2","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"eval({for (input in c('CUSTOMER_ID')) { if(!input %in% names(.)) stop(paste(\"The schema has changed. Edit the operation and click Apply.\"), call. = FALSE) else .}})%>%mutate(`CUSTOMER_ID` = as.double(`CUSTOMER_ID`))","args":{"type":"mutate","conditions":[],"auto":true,"autoConditions":[{"column":"CUSTOMER_ID","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false}],"version":1}}},"parameters":{"FREEFORM_CODE":"mutate(`CUSTOMER_ID` = as.double(`CUSTOMER_ID`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"source1","port_id_ref":"source1output"}]}],"outputs":[{"id":"outputPort1"}]},{"id":"4d60ffb9-3d9d-4f54-b410-6efb2458c16c","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"aggregateOp","code":"group_by(`EVENT_TYPE_ID`)%>% summarize(`total` = n_distinct(`CUSTOMER_ID`))%>% ungroup()","args":{"outColumnNames":"total","column":"CUSTOMER_ID","groupByColumns":["EVENT_TYPE_ID"],"groupByOption":true,"conditions":[{"newColumnName":"total","type":"Count unique values"}]}}},"parameters":{"FREEFORM_CODE":"group_by(`EVENT_TYPE_ID`)%>% summarize(`total` = n_distinct(`CUSTOMER_ID`))%>% ungroup()"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"8c811ea7-0dbd-423b-9e89-2f0205610be2","port_id_ref":"outputPort1"}]}],"outputs":[{"id":"outputPort2"}]},{"data_asset":{"properties":{"file_format":"csv","mode":"overwrite","first_line_header":true,"name":"event_total.csv"},"project_ref":"1ced1e1f-6da1-493b-b3e5-92cdf8bbc935","app_data":{"description":"","project_name":"TestR","targetType":"dataAsset"}},"id":"target1","type":"binding","input":{"id":"targetInput1","link":{"node_id_ref":"4d60ffb9-3d9d-4f54-b410-6efb2458c16c","port_id_ref":"outputPort2"}}}],"runtime":"Spark"}]}}